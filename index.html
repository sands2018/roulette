<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<style>

.g_c { background-color: #33B800; }
.r_c { background-color: #CC2200; }
.b_c { background-color: #222222; }
.g_cn { background-color: #EEEEEE; }
.r_cn { background-color: #EEEEEE; }
.b_cn { background-color: #EEEEEE; }

td 
{
	text-align: center;
	vertical-align: middle;
	cursor: hand;
}

#tblBoard td 
{
	width: 90px;
	height: 90px;
	font-size: 40px;
	border: 1px solid #FFFC88;
	color: #FFFFFF;
}

#tblQueue td 
{
	width: 55px;
	height: 55px;
	font-size: 28px;
	background-color: #AAAAAA;
	color: #FFFFFF;
}

.title_c,.value_c { font-size: 26px; padding: 7px 0px 5px 0px; }
.title_c { background-color: #DFD7CB; width: 110px; color: #403000 }
.value_c { background-color: #EBE3CB; width: 70px; border-left: 1px solid white; }

</style>

<script language="javascript">

var MAX_COUNT = 100;
var g_anNum = [];
var g_nIdx = -1;
var g_astrNumberColor = 
[
	"g",
    "r", "b", "r", "b", "r", "b", "r", "b", "r", "b", "b", "r",
	"b", "r", "b", "r", "b", "r", "r", "b", "r", "b", "r", "b", 
	"r", "b", "r", "b", "b", "r", "b", "r", "b", "r", "b", "r" 
];

var g_an3C3R = [];
var g_anIdx3C3R = [];

function GetNumberColor(strNum)
{
    var strColor = g_astrNumberColor[parseInt(strNum)];
	if(strColor == "r")
	{
		return "#CC2200";
	}
	else if(strColor == "b")
	{
		return "#222222";
	}
	else
	{
		return "#33B800";
	}
}

function ShowQueue()
{
	for(n = 0; n <= g_nIdx; ++n)
	{
		var strIdTd = "td" + n.toString();
		var td = document.getElementById(strIdTd);
		td.innerHTML = g_anNum[g_nIdx - n];
		td.style.backgroundColor = GetNumberColor(g_anNum[g_nIdx - n]);
	}

	for(n = g_nIdx + 1; n < MAX_COUNT; ++ n)
	{
		var strIdTd = "td" + n.toString();
		var td = document.getElementById(strIdTd);
		td.innerHTML = "&nbsp;";
		td.style.backgroundColor = "#FFFFFF";
	}
}

function Calc3C3R_Add(num)
{
    if(num == 0) return;
	
    var nCol = Math.floor((num - 1) / 12);
    var nRow = num % 3;
    if(nRow == 1)
    {
        nRow = 2;
    }
    else if(nRow == 2)
    {
        nRow = 1;
    }
	
    for(n = 0; n < 6; ++ n)
    {
        if ((g_anIdx3C3R[n] == nCol) || (g_anIdx3C3R[n] == (3 + nRow)))
        {
            g_an3C3R[n] = 0;
        }
        else
        {
            g_an3C3R[n]++;
        }
    }
}

function Show3C3R()
{
    // sort:
    var bChanged = false;
    do
    {
        bChanged = false;

        for (n = 0; n < 5; ++n)
        {
            if(g_an3C3R[n] < g_an3C3R[n + 1])
            {
                var tmp = g_an3C3R[n];
                g_an3C3R[n] = g_an3C3R[n + 1];
                g_an3C3R[n + 1] = tmp;

                tmp = g_anIdx3C3R[n];
                g_anIdx3C3R[n] = g_anIdx3C3R[n + 1];
                g_anIdx3C3R[n + 1] = tmp;

                bChanged = true;
            }
        }
    } while (bChanged);

	for(n = 0; n < 6; ++n)
	{
		var strIdTd = "td3C3R" + n.toString();
		var td = document.getElementById(strIdTd);
		td.innerHTML = g_an3C3R[n];
		if (g_an3C3R[n] >= 5)
		{
		    if (g_an3C3R[n] > 5)
		        td.style.fontWeight = "bold";
            else
		        td.style.fontWeight = "normal";
            td.style.color = "red";
        }
        else
        {
            td.style.fontWeight = "normal";
            td.style.color = "black";
		}

		strIdTd = "tdT3C3R" + n.toString();
		var strTitle = "第";
		if (g_anIdx3C3R[n] < 3)
		{
		    strTitle += (g_anIdx3C3R[n] + 1).toString() + "组";
		}
		else
		{
		    strTitle += (g_anIdx3C3R[n] - 2).toString() + "行";
		}
		td = document.getElementById(strIdTd);
		td.innerHTML = strTitle;
    }
}

function OnPageInit()
{
	g_nIdx = -1;
	for(n = 0; n < MAX_COUNT; n++)
		g_anNum[n] = -1;

	for(n = 0; n < 6; ++ n)
	{
	    g_an3C3R[n] = 0;
	    g_anIdx3C3R[n] = n;
	}
		
	ShowQueue();
}

function OnClick(num)
{
    Calc3C3R_Add(num);
    Show3C3R();
	
	if(g_nIdx == (MAX_COUNT - 1))
	{
		for(n = 0; n <= g_nIdx - 1; ++ n)
		{
			g_anNum[n] = g_anNum[n + 1];
		}
	}
	else
	{
		g_nIdx ++;
	}
	
	g_anNum[g_nIdx] = num;
	
	ShowQueue();
}


</script>

</head>
<body onload="OnPageInit()">
    <table cellpadding="0" cellspacing="0" style="border: 1px solid #FFFC88" id="tblBoard">
        <tr>
            <td class="g_c" rowspan="3" onclick="OnClick(0)">0</td>
            <td class="r_c" onclick="OnClick(3)">3</td>
            <td class="b_c" onclick="OnClick(6)">6</td>
            <td class="r_c" onclick="OnClick(9)">9</td>
            <td class="r_c" onclick="OnClick(12)">12</td>
            <td class="b_c" onclick="OnClick(15)">15</td>
            <td class="r_c" onclick="OnClick(18)">18</td>
            <td class="r_c" onclick="OnClick(21)">21</td>
            <td class="b_c" onclick="OnClick(24)">24</td>
            <td class="r_c" onclick="OnClick(27)">27</td>
            <td class="r_c" onclick="OnClick(30)">30</td>
            <td class="b_c" onclick="OnClick(33)">33</td>
            <td class="r_c" onclick="OnClick(36)">36</td>
        </tr>
        <tr>
            <td class="b_c" onclick="OnClick(2)">2</td>
            <td class="r_c" onclick="OnClick(5)">5</td>
            <td class="b_c" onclick="OnClick(8)">8</td>
            <td class="b_c" onclick="OnClick(11)">11</td>
            <td class="r_c" onclick="OnClick(14)">14</td>
            <td class="b_c" onclick="OnClick(17)">17</td>
            <td class="b_c" onclick="OnClick(20)">20</td>
            <td class="r_c" onclick="OnClick(23)">23</td>
            <td class="b_c" onclick="OnClick(26)">26</td>
            <td class="b_c" onclick="OnClick(29)">29</td>
            <td class="r_c" onclick="OnClick(32)">32</td>
            <td class="b_c" onclick="OnClick(35)">35</td>
        </tr>
        <tr>
            <td class="r_c" onclick="OnClick(1)">1</td>
            <td class="b_c" onclick="OnClick(4)">4</td>
            <td class="r_c" onclick="OnClick(7)">7</td>
            <td class="b_c" onclick="OnClick(10)">10</td>
            <td class="b_c" onclick="OnClick(13)">13</td>
            <td class="r_c" onclick="OnClick(16)">16</td>
            <td class="r_c" onclick="OnClick(19)">19</td>
            <td class="b_c" onclick="OnClick(22)">22</td>
            <td class="r_c" onclick="OnClick(25)">25</td>
            <td class="b_c" onclick="OnClick(28)">28</td>
            <td class="b_c" onclick="OnClick(31)">31</td>
            <td class="r_c" onclick="OnClick(34)">34</td>
        </tr>
    </table>
	<table cellpadding="0" cellspacing="0" border="0" id="tblStatistics">
	<tr><td colspan="17" height="8px"></td></tr>
	<tr>
		<td class="title_c" id="tdT3C3R0">第1组</td><td class="value_c" id="td3C3R0">0</td><td>&nbsp;&nbsp;</td>
		<td class="title_c" id="tdT3C3R1">第2组</td><td class="value_c" id="td3C3R1">0</td><td>&nbsp;&nbsp;</td>
		<td class="title_c" id="tdT3C3R2">第3组</td><td class="value_c" id="td3C3R2">0</td><td>&nbsp;&nbsp;</td>
		<td class="title_c" id="tdT3C3R3">第1行</td><td class="value_c" id="td3C3R3">0</td><td>&nbsp;&nbsp;</td>
		<td class="title_c" id="tdT3C3R4">第2行</td><td class="value_c" id="td3C3R4">0</td><td>&nbsp;&nbsp;</td>
		<td class="title_c" id="tdT3C3R5">第3行</td><td class="value_c" id="td3C3R5">0</td>
	</tr>
	<tr><td colspan="8" height="8px"></td></tr>
	</table>
    <table cellpadding="0" cellspacing="5" border="0" id="tblQueue">
        <tr>
            <td id="td0"></td>
            <td id="td1"></td>
            <td id="td2"></td>
            <td id="td3"></td>
            <td id="td4"></td>
            <td id="td5"></td>
            <td id="td6"></td>
            <td id="td7"></td>
            <td id="td8"></td>
            <td id="td9"></td>
            <td id="td10"></td>
            <td id="td11"></td>
            <td id="td12"></td>
            <td id="td13"></td>
            <td id="td14"></td>
            <td id="td15"></td>
            <td id="td16"></td>
            <td id="td17"></td>
            <td id="td18"></td>
            <td id="td19"></td>
        </tr>
        <tr>
            <td id="td20"></td>
            <td id="td21"></td>
            <td id="td22"></td>
            <td id="td23"></td>
            <td id="td24"></td>
            <td id="td25"></td>
            <td id="td26"></td>
            <td id="td27"></td>
            <td id="td28"></td>
            <td id="td29"></td>
            <td id="td30"></td>
            <td id="td31"></td>
            <td id="td32"></td>
            <td id="td33"></td>
            <td id="td34"></td>
            <td id="td35"></td>
            <td id="td36"></td>
            <td id="td37"></td>
            <td id="td38"></td>
            <td id="td39"></td>
        </tr>
        <tr>
            <td id="td40"></td>
            <td id="td41"></td>
            <td id="td42"></td>
            <td id="td43"></td>
            <td id="td44"></td>
            <td id="td45"></td>
            <td id="td46"></td>
            <td id="td47"></td>
            <td id="td48"></td>
            <td id="td49"></td>
            <td id="td50"></td>
            <td id="td51"></td>
            <td id="td52"></td>
            <td id="td53"></td>
            <td id="td54"></td>
            <td id="td55"></td>
            <td id="td56"></td>
            <td id="td57"></td>
            <td id="td58"></td>
            <td id="td59"></td>
        </tr>
        <tr>
            <td id="td60"></td>
            <td id="td61"></td>
            <td id="td62"></td>
            <td id="td63"></td>
            <td id="td64"></td>
            <td id="td65"></td>
            <td id="td66"></td>
            <td id="td67"></td>
            <td id="td68"></td>
            <td id="td69"></td>
            <td id="td70"></td>
            <td id="td71"></td>
            <td id="td72"></td>
            <td id="td73"></td>
            <td id="td74"></td>
            <td id="td75"></td>
            <td id="td76"></td>
            <td id="td77"></td>
            <td id="td78"></td>
            <td id="td79"></td>
        </tr>
        <tr>
            <td id="td80"></td>
            <td id="td81"></td>
            <td id="td82"></td>
            <td id="td83"></td>
            <td id="td84"></td>
            <td id="td85"></td>
            <td id="td86"></td>
            <td id="td87"></td>
            <td id="td88"></td>
            <td id="td89"></td>
            <td id="td90"></td>
            <td id="td91"></td>
            <td id="td92"></td>
            <td id="td93"></td>
            <td id="td94"></td>
            <td id="td95"></td>
            <td id="td96"></td>
            <td id="td97"></td>
            <td id="td98"></td>
            <td id="td99"></td>
        </tr>
    </table>


</body>
</html>