<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<style>

td 
{
	text-align: center;
	vertical-align: middle;
	cursor: pointer;
}

#tblBoard
{
    border: 1px solid #DFBC33;
}

#tblBoard td 
{
	width: 90px;
	height: 70px;
	font-size: 40px;
	border: 1px solid #DFBC33;
	color: #FFFFFF;
}

#tblQueue td 
{
	width: 55px;
	height: 50px;
	font-size: 28px;
	background-color: #AAAAAA;
	color: #FFFFFF;
}

.bttn 
{
	width: 180px;
	height: 50px;
    line-height: 50px;
    text-align: center;
    vertical-align: middle;
	font-size: 28px;
    color: white;
    border: 1px solid white;
}

.title_c,.value_c { font-size: 26px; padding: 7px 0px 5px 0px; border: 1px solid white;}
.title_c { background-color: #DFD7CB; width: 110px; color: #403000 }
.value_c { background-color: #EBE3CB; width: 70px; border-left: 0; }

</style>

<script language="javascript">


    // styles: >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

    var g_s_theme_id = 1;

    var g_astrNumberColor =
    [
	    "g",
        "r", "b", "r", "b", "r", "b", "r", "b", "r", "b", "b", "r",
	    "b", "r", "b", "r", "b", "r", "r", "b", "r", "b", "r", "b",
	    "r", "b", "r", "b", "b", "r", "b", "r", "b", "r", "b", "r"
    ];

    // number text color:
    var g_s_c_num = ["white", "#434343"];

    // number background color:
    var g_s_c_num_bk_g = ["#35A300", "white"]; // green
    var g_s_c_num_bk_r = ["#CC2200", "white"]; // red
    var g_s_c_num_bk_b = ["#222222", "white"]; // black

    // queue background color:
    var g_s_c_que_bk_g = ["35A300", "#D3EED3"]; // green
    var g_s_c_que_bk_r = ["CC2200", "white"]; // red
    var g_s_c_que_bk_b = ["222222", "#EAEAEA"]; // black

    // queue border color:
    var g_s_c_que_b_g = ["white", "#CCFFCC"]; 
    var g_s_c_que_b_r = ["white", "#FFDDAA"]; 
    var g_s_c_que_b_b = ["white", "#DDDDDD"]; 

    // button background color:
    var g_s_c_btn_bk_enabled = ["#008838", "white"];
    var g_s_c_btn_bk_disabled = ["#888888", "white"];

    // button text color:
    var g_s_c_btn_enabled = ["white", "#AA8833"];
    var g_s_c_btn_disabled = ["white", "BBBBBB"];

    // button border color:
    var g_s_c_btn_b_enabled = ["white", "#AA8833"];
    var g_s_c_btn_b_disabled = ["white", "BBBBBB"];

    // 3c3r color
    var g_s_c_3c3r = ["black", "black"]; // text color
    var g_s_c_3c3r_bk = ["#EBE3CB", "white"]; // background color
    var g_s_c_3c3r_t_bk = ["#DFD7CB", "white"]; // title background color

    // 3c3r >=5 color
    var g_s_c_3c3r_5 = ["white", "black"]; // text color
    var g_s_c_3c3r_5_bk = ["rgb(158,118,200)", "#EEEEEE"]; // background color
    var g_s_c_3c3r_5_t_bk = ["rgb(128,88,158)", "#DDDDDD"]; // title background color

    // 3c3r >=6 background color
    var g_s_c_3c3r_6 = ["white", "black"]; // text color
    var g_s_c_3c3r_6_bk = ["rgb(0,128,255)", "#EBE3CB"]; // background color
    var g_s_c_3c3r_6_t_bk = ["rgb(0,93,218)", "#DFD7CB"]; // title background color

    // 3c3r border color
    var g_s_c_3c3r_b = ["white", "#AA8833"];

    function GetNumberColor()
    {
        return g_s_c_num[g_s_theme_id];
    }

    function GetNumberBackgroundColor(num)
    {
        var strColor = g_astrNumberColor[num];

	    if(strColor == "r")
	    {
	        return g_s_c_num_bk_r[g_s_theme_id];
	    }
	    else if(strColor == "b")
	    {
	        return g_s_c_num_bk_b[g_s_theme_id];
	    }
	    else
	    {
	        return g_s_c_num_bk_g[g_s_theme_id];
	    }
    }

    function GetQueueNumberBackgroundColor(num)
    {
        var strColor = g_astrNumberColor[num];

        if (strColor == "r") {
            return g_s_c_que_bk_r[g_s_theme_id];
        }
        else if (strColor == "b") {
            return g_s_c_que_bk_b[g_s_theme_id];
        }
        else {
            return g_s_c_que_bk_g[g_s_theme_id];
        }
    }

    function GetQueueNumberBorderColor(num)
    {
        var strColor = g_astrNumberColor[num];

        if (strColor == "r") {
            return g_s_c_que_b_r[g_s_theme_id];
        }
        else if (strColor == "b") {
            return g_s_c_que_b_b[g_s_theme_id];
        }
        else {
            return g_s_c_que_b_g[g_s_theme_id];
        }
    }


    function InitStyles()
    {
        for(n = 0; n <= 36; ++n)
        {
            var td = document.getElementById("tdB" + n.toString());
            td.style.backgroundColor = GetNumberBackgroundColor(n);
            td.style.color = GetNumberColor();
        }
    }

    function GetQueueItemBorderStyle(num)
    {
        return "1px solid " + GetQueueNumberBorderColor(num);
    }

    // styles: <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<


    var MAX_COUNT = 100;
    var g_anNum = [];
    var g_nIdx = -1;

    var g_an3C3R = [];
    var g_anIdx3C3R = [];

    var g_nExpandStatus = 0;

    function ShowQueue()
    {
        for (n = 0; n <= g_nIdx; ++n)
	    {
		    var strIdTd = "td" + n.toString();
		    var td = document.getElementById(strIdTd);
		    td.innerHTML = g_anNum[g_nIdx - n];
		    td.style.backgroundColor = GetQueueNumberBackgroundColor(g_anNum[g_nIdx - n]);
		    td.style.color = GetNumberColor();
		    td.style.border = GetQueueItemBorderStyle(g_anNum[g_nIdx - n]);
        }

	    for(n = g_nIdx + 1; n < MAX_COUNT; ++ n)
	    {
		    var strIdTd = "td" + n.toString();
		    var td = document.getElementById(strIdTd);
		    td.innerHTML = "&nbsp;";
		    td.style.backgroundColor = "#FFFFFF";
	    }

	    var nQueueRow = 0;

	    if (g_nIdx >= 0)
        {
	        nQueueRow = Math.floor(g_nIdx / 20) + 1;
	    }

	    var strID = "divBlank";
	    var div = document.getElementById(strID);
	    if (nQueueRow == 0)
	        div.style.display = "none";
	    else
	        div.style.display = "";

	    for (n = 1; n <= 5; ++n)
	    {
	        strID = "trRow" + n.toString();
	        var tr = document.getElementById(strID);
	        if ((nQueueRow > 0) && ((n == 1) || ((n <= nQueueRow) && (g_nExpandStatus == 1))))
	            tr.style.display = "";
            else
	            tr.style.display = "none";
	    }
    }

    function RefreshButtons()
    {
        var strBkClrDisabled = g_s_c_btn_bk_disabled[g_s_theme_id];
        var strBkClrEnabled = g_s_c_btn_bk_enabled[g_s_theme_id];

        var strClrDisabled = g_s_c_btn_disabled[g_s_theme_id];
        var strClrEnabled = g_s_c_btn_enabled[g_s_theme_id];

        var strBorderClrDisabled = g_s_c_btn_b_disabled[g_s_theme_id];
        var strBorderClrEnabled = g_s_c_btn_b_enabled[g_s_theme_id];

        var strBkClrDelete = strBkClrDisabled;
        var strClrDelete = strClrDisabled;
        var strBorderClrDelete = strBorderClrDisabled;

        var strBkClrExpand = strBkClrDisabled;
        var strClrExpand = strClrDisabled;
        var strBorderClrExpand = strBorderClrDisabled;

        var strBkClrRestart = strBkClrDisabled;
        var strClrRestart = strClrDisabled;
        var strBorderClrRestart = strBorderClrDisabled;

        var strBkClrTheme = strBkClrEnabled;
        var strClrTheme = strClrEnabled;
        var strBorderClrTheme = strBorderClrEnabled;

        if(g_nIdx >= 0)
        {
            strBkClrDelete = strBkClrEnabled;
            strClrDelete = strClrEnabled;
            strBorderClrDelete = strBorderClrEnabled;

            strBkClrRestart = strBkClrEnabled;
            strClrRestart = strClrEnabled;
            strBorderClrRestart = strBorderClrEnabled;
        }
        if(g_nIdx >= 20)
        {
            strBkClrExpand = strBkClrEnabled;
            strClrExpand = strClrEnabled;
            strBorderClrExpand = strBorderClrEnabled;
        }
        else
        {
            g_nExpandStatus = 0;
        }

        var strBttnExpand = "展开";
        if(g_nExpandStatus == 1)
        {
            strBttnExpand = "收起";
        }

        var bttn = document.getElementById("tdBttnDelete");
        bttn.style.backgroundColor = strBkClrDelete;
        bttn.style.color = strClrDelete;
        bttn.style.borderColor = strBorderClrDelete;

        bttn = document.getElementById("tdBttnExpand");
        bttn.style.backgroundColor = strBkClrExpand;
        bttn.style.color = strClrExpand;
        bttn.style.borderColor = strBorderClrExpand;
        bttn.innerHTML = strBttnExpand;

        bttn = document.getElementById("tdBttnRestart");
        bttn.style.backgroundColor = strBkClrRestart;
        bttn.style.color = strClrRestart;
        bttn.style.borderColor = strBorderClrRestart;

        bttn = document.getElementById("tdBttnTheme");
        bttn.style.backgroundColor = strBkClrTheme;
        bttn.style.color = strClrTheme;
        bttn.style.borderColor = strBorderClrTheme;
    }

    function Calc3C3R_Add(num)
    {
        if(num == 0) return;
	
        var nCol = Math.floor((num - 1) / 12);
        var nRow = num % 3;
        if(nRow == 1)
        {
            nRow = 2;
        }
        else if(nRow == 2)
        {
            nRow = 1;
        }

        for (n = 0; n < 6; ++n)
        {
            g_an3C3R[n]++;
        }

        g_an3C3R[nCol] = 0;
        g_an3C3R[3+nRow] = 0;
    }

    function Calc3C3R_Delete()
    {
        var abOccur = [];

        for (n = 0; n < 6; ++n)
        {
            g_an3C3R[n] = 0;
            g_anIdx3C3R[n] = n;
            abOccur[n] = false;
        }

        for(n = g_nIdx; n >= 0; --n)
        {
            var num = g_anNum[n];
            if (num == 0) continue;

            var nCol = Math.floor((num - 1) / 12);
            var nRow = num % 3;
            if (nRow == 1) {
                nRow = 2;
            }
            else if (nRow == 2) {
                nRow = 1;
            }

            var bChanged = false;

            for(nn = 0; nn < 6; ++ nn)
            {
                if(!abOccur[nn])
                {
                    if((nn == nCol) || (nn == (nRow + 3)))
                    {
                        abOccur[nn] = true;
                    }
                    else
                    {
                        g_an3C3R[nn]++;
                        bChanged = true;
                    }
                }
            }

            if (!bChanged)
                break;
        }
    }

    function Sort3C3R()
    {
        // sort:
        var bChanged = false;
        do {
            bChanged = false;

            for (n = 0; n < 5; ++n) {
                if (g_an3C3R[g_anIdx3C3R[n]] < g_an3C3R[g_anIdx3C3R[n + 1]]) {
                    tmp = g_anIdx3C3R[n];
                    g_anIdx3C3R[n] = g_anIdx3C3R[n + 1];
                    g_anIdx3C3R[n + 1] = tmp;

                    bChanged = true;
                }
            }
        } while (bChanged);
    }

    function Show3C3R()
    {
        // show:
	    for(n = 0; n < 6; ++n)
	    {
		    var strIdTd = "td3C3R" + n.toString();
		    var td = document.getElementById(strIdTd);
		    td.innerHTML = g_an3C3R[g_anIdx3C3R[n]];
		    strIdTd = "tdT3C3R" + n.toString();
		    var strTitle = "第";
		    if (g_anIdx3C3R[n] < 3)
		    {
		        if (g_anIdx3C3R[n] == 0)
    		        strTitle += "一组";
		        else if (g_anIdx3C3R[n] == 1)
		            strTitle += "二组";
		        else 
		            strTitle += "三组";
            }
		    else
		    {
		        strTitle += (g_anIdx3C3R[n] - 2).toString() + "行";
		    }
		    var tdT = document.getElementById(strIdTd);
		    tdT.innerHTML = strTitle;

		    if (g_an3C3R[g_anIdx3C3R[n]] >= 5)
		    {
		        if (g_an3C3R[g_anIdx3C3R[n]] > 5)
                {
		            td.style.color = g_s_c_3c3r_6[g_s_theme_id];
		            tdT.style.color = g_s_c_3c3r_6[g_s_theme_id];
		            td.style.backgroundColor = g_s_c_3c3r_6_bk[g_s_theme_id];
		            tdT.style.backgroundColor = g_s_c_3c3r_6_t_bk[g_s_theme_id];
		        }
                else
		        {
		            td.style.color = g_s_c_3c3r_5[g_s_theme_id];
		            tdT.style.color = g_s_c_3c3r_5[g_s_theme_id];
		            td.style.backgroundColor = g_s_c_3c3r_5_bk[g_s_theme_id];
		            tdT.style.backgroundColor = g_s_c_3c3r_5_t_bk[g_s_theme_id];
                }
		        td.style.fontWeight = "bold";
            }
            else
		    {
		        td.style.color = g_s_c_3c3r[g_s_theme_id];
		        tdT.style.color = g_s_c_3c3r[g_s_theme_id];
		        td.style.backgroundColor = g_s_c_3c3r_bk[g_s_theme_id];
		        tdT.style.backgroundColor = g_s_c_3c3r_t_bk[g_s_theme_id];

		        td.style.fontWeight = "normal";
		    }

		    td.style.borderColor = g_s_c_3c3r_b[g_s_theme_id];
		    tdT.style.borderColor = g_s_c_3c3r_b[g_s_theme_id];
        }
    }

    function RefreshTheme()
    {
        var strTitle = "淡雅版";

        if(g_s_theme_id == 1)
        {
            strTitle = "彩色版";
        }

        var bttn = document.getElementById("tdBttnTheme");
        bttn.innerHTML = strTitle;

        InitStyles();
        Show3C3R();
        ShowQueue();
        RefreshButtons();
    }

    function OnPageInit()
    {
	    g_nIdx = -1;
	    for(n = 0; n < MAX_COUNT; n++)
		    g_anNum[n] = -1;

	    for(n = 0; n < 6; ++ n)
	    {
	        g_an3C3R[n] = 0;
	        g_anIdx3C3R[n] = n;
	    }

	    RefreshTheme();
    }

    function OnClick(num)
    {
        Calc3C3R_Add(num);
        Sort3C3R();
        Show3C3R();
	
	    if(g_nIdx == (MAX_COUNT - 1))
	    {
		    for(n = 0; n <= g_nIdx - 1; ++ n)
		    {
			    g_anNum[n] = g_anNum[n + 1];
		    }
	    }
	    else
	    {
		    g_nIdx ++;
	    }
	
	    g_anNum[g_nIdx] = num;
	
	    ShowQueue();
	    RefreshButtons();
    }

    function OnDelete()
    {
        if (g_nIdx < 0)
            return;

        if(g_nIdx == 0)
        {
            OnPageInit();
            return;
        }

        --g_nIdx;

        Calc3C3R_Delete();

        Sort3C3R();
        Show3C3R();
        ShowQueue();
        RefreshButtons();
    }

    function OnExpand()
    {
        g_nExpandStatus++;
        g_nExpandStatus = g_nExpandStatus % 2;

        ShowQueue();
        RefreshButtons();
    }

    function OnRestart()
    {
        if (g_nIdx < 0)
            return;
        z
        var confirmed = confirm("确定要重新开始？");
        if(confirmed != 0)
            OnPageInit();
    }

    function OnChangeTheme()
    {
        if(g_s_theme_id == 0)
        {
            g_s_theme_id = 1;
        }
        else
        {
            g_s_theme_id = 0;
        }

        RefreshTheme();
    }

</script>

</head>
<body onload="OnPageInit()">
    <table cellpadding="0" cellspacing="0" id="tblBoard">
        <tr>
            <td id="tdB0" rowspan="3" onclick="OnClick(0)">0</td>
            <td id="tdB3" onclick="OnClick(3)">3</td>
            <td id="tdB6" onclick="OnClick(6)">6</td>
            <td id="tdB9" onclick="OnClick(9)">9</td>
            <td id="tdB12" onclick="OnClick(12)">12</td>
            <td id="tdB15" onclick="OnClick(15)">15</td>
            <td id="tdB18" onclick="OnClick(18)">18</td>
            <td id="tdB21" onclick="OnClick(21)">21</td>
            <td id="tdB24" onclick="OnClick(24)">24</td>
            <td id="tdB27" onclick="OnClick(27)">27</td>
            <td id="tdB30" onclick="OnClick(30)">30</td>
            <td id="tdB33" onclick="OnClick(33)">33</td>
            <td id="tdB36" onclick="OnClick(36)">36</td>
        </tr>
        <tr>
            <td id="tdB2" onclick="OnClick(2)">2</td>
            <td id="tdB5" onclick="OnClick(5)">5</td>
            <td id="tdB8" onclick="OnClick(8)">8</td>
            <td id="tdB11" onclick="OnClick(11)">11</td>
            <td id="tdB14" onclick="OnClick(14)">14</td>
            <td id="tdB17" onclick="OnClick(17)">17</td>
            <td id="tdB20" onclick="OnClick(20)">20</td>
            <td id="tdB23" onclick="OnClick(23)">23</td>
            <td id="tdB26" onclick="OnClick(26)">26</td>
            <td id="tdB29" onclick="OnClick(29)">29</td>
            <td id="tdB32" onclick="OnClick(32)">32</td>
            <td id="tdB35" onclick="OnClick(35)">35</td>
        </tr>
        <tr>
            <td id="tdB1" onclick="OnClick(1)">1</td>
            <td id="tdB4" onclick="OnClick(4)">4</td>
            <td id="tdB7" onclick="OnClick(7)">7</td>
            <td id="tdB10" onclick="OnClick(10)">10</td>
            <td id="tdB13" onclick="OnClick(13)">13</td>
            <td id="tdB16" onclick="OnClick(16)">16</td>
            <td id="tdB19" onclick="OnClick(19)">19</td>
            <td id="tdB22" onclick="OnClick(22)">22</td>
            <td id="tdB25" onclick="OnClick(25)">25</td>
            <td id="tdB28" onclick="OnClick(28)">28</td>
            <td id="tdB31" onclick="OnClick(31)">31</td>
            <td id="tdB34" onclick="OnClick(34)">34</td>
        </tr>
    </table>
    <div style="height: 8px"></div>
	<table cellpadding="0" cellspacing="0" border="0" id="tblStatistics">
	<tr>
		<td class="title_c" id="tdT3C3R0">第1组</td><td class="value_c" id="td3C3R0">0</td><td>&nbsp;&nbsp;</td>
		<td class="title_c" id="tdT3C3R1">第2组</td><td class="value_c" id="td3C3R1">0</td><td>&nbsp;&nbsp;</td>
		<td class="title_c" id="tdT3C3R2">第3组</td><td class="value_c" id="td3C3R2">0</td><td>&nbsp;&nbsp;</td>
		<td class="title_c" id="tdT3C3R3">第1行</td><td class="value_c" id="td3C3R3">0</td><td>&nbsp;&nbsp;</td>
		<td class="title_c" id="tdT3C3R4">第2行</td><td class="value_c" id="td3C3R4">0</td><td>&nbsp;&nbsp;</td>
		<td class="title_c" id="tdT3C3R5">第3行</td><td class="value_c" id="td3C3R5">0</td>
	</tr>
	</table>
    <div style="height: 8px" id="divBlank"></div>
    <table cellpadding="0" cellspacing="5" border="0" id="tblQueue">
        <tr id="trRow1">
            <td id="td0"></td>
            <td id="td1"></td>
            <td id="td2"></td>
            <td id="td3"></td>
            <td id="td4"></td>
            <td id="td5"></td>
            <td id="td6"></td>
            <td id="td7"></td>
            <td id="td8"></td>
            <td id="td9"></td>
            <td id="td10"></td>
            <td id="td11"></td>
            <td id="td12"></td>
            <td id="td13"></td>
            <td id="td14"></td>
            <td id="td15"></td>
            <td id="td16"></td>
            <td id="td17"></td>
            <td id="td18"></td>
            <td id="td19"></td>
        </tr>
        <tr id="trRow2">
            <td id="td20"></td>
            <td id="td21"></td>
            <td id="td22"></td>
            <td id="td23"></td>
            <td id="td24"></td>
            <td id="td25"></td>
            <td id="td26"></td>
            <td id="td27"></td>
            <td id="td28"></td>
            <td id="td29"></td>
            <td id="td30"></td>
            <td id="td31"></td>
            <td id="td32"></td>
            <td id="td33"></td>
            <td id="td34"></td>
            <td id="td35"></td>
            <td id="td36"></td>
            <td id="td37"></td>
            <td id="td38"></td>
            <td id="td39"></td>
        </tr>
        <tr id="trRow3">
            <td id="td40"></td>
            <td id="td41"></td>
            <td id="td42"></td>
            <td id="td43"></td>
            <td id="td44"></td>
            <td id="td45"></td>
            <td id="td46"></td>
            <td id="td47"></td>
            <td id="td48"></td>
            <td id="td49"></td>
            <td id="td50"></td>
            <td id="td51"></td>
            <td id="td52"></td>
            <td id="td53"></td>
            <td id="td54"></td>
            <td id="td55"></td>
            <td id="td56"></td>
            <td id="td57"></td>
            <td id="td58"></td>
            <td id="td59"></td>
        </tr>
        <tr id="trRow4">
            <td id="td60"></td>
            <td id="td61"></td>
            <td id="td62"></td>
            <td id="td63"></td>
            <td id="td64"></td>
            <td id="td65"></td>
            <td id="td66"></td>
            <td id="td67"></td>
            <td id="td68"></td>
            <td id="td69"></td>
            <td id="td70"></td>
            <td id="td71"></td>
            <td id="td72"></td>
            <td id="td73"></td>
            <td id="td74"></td>
            <td id="td75"></td>
            <td id="td76"></td>
            <td id="td77"></td>
            <td id="td78"></td>
            <td id="td79"></td>
        </tr>
        <tr id="trRow5">
            <td id="td80"></td>
            <td id="td81"></td>
            <td id="td82"></td>
            <td id="td83"></td>
            <td id="td84"></td>
            <td id="td85"></td>
            <td id="td86"></td>
            <td id="td87"></td>
            <td id="td88"></td>
            <td id="td89"></td>
            <td id="td90"></td>
            <td id="td91"></td>
            <td id="td92"></td>
            <td id="td93"></td>
            <td id="td94"></td>
            <td id="td95"></td>
            <td id="td96"></td>
            <td id="td97"></td>
            <td id="td98"></td>
            <td id="td99"></td>
        </tr>
    </table>
    <div style="height: 8px"></div>

    <table cellpadding="0" cellspacing="0" border="0">
        <tr>
            <td id="tdBttnDelete" class="bttn" style="background-color: #007820" onclick="OnDelete()">删除</td><td>&nbsp;&nbsp;&nbsp;</td>
            <td id="tdBttnExpand" class="bttn" style="background-color: #007820" onclick="OnExpand()">展开</td><td>&nbsp;&nbsp;&nbsp;</td>
            <td id="tdBttnRestart" class="bttn" style="background-color: #007820" onclick="OnRestart()">重新开始</td><td>&nbsp;&nbsp;&nbsp;</td>
            <td id="tdBttnTheme" class="bttn" style="background-color: #007820" onclick="OnChangeTheme()">NA</td>
        </tr>
    </table>
</body>
</html>