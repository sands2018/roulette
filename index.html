<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<style>

td 
{
	text-align: center;
	vertical-align: middle;
	cursor: pointer;
}

#tblBoard
{
    border: 1px solid;
}

#tblBoard td 
{
	width: 90px;
	height: 70px;
	font-size: 40px;
	border: 1px solid;
}

#tblQueue td 
{
	width: 55px;
	height: 50px;
	font-size: 28px;
}

.bttn 
{
	width: 180px;
	height: 50px;
    line-height: 50px;
    text-align: center;
    vertical-align: middle;
	font-size: 28px;
    border: 1px solid white;
}

.title_c,.value_c { font-size: 26px; padding: 7px 0px 5px 0px; border: 1px solid;}
.title_c { width: 110px; color: #403000 }
.value_c { width: 70px; border-left: 0; }

table.tblGameSum td { font-size: 28px; padding-right: 20px; }
.tblGame { border: #8f8f8f 1px solid; margin-bottom: 18px; }
table.tblGame td { font-size: 28px; }
tr.trTitle td { color: #434343; padding: 0px 30px; }
tr.trItems td { text-align: center; padding: 0px 20px; border-top: #8f8f8f 1px solid; }  
tr.trActive td { color: black; }
tr.trWon td { color: #c38f8f; }
tr.trDrew td { color: #a3a3a3; }
tr.trLost td { color: #8fc38f; }

</style>

<script language="javascript">


    // styles: >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

    var g_s_theme_id = 1;

    var g_astrNumberColor =
    [
	    "g",
        "r", "b", "r", "b", "r", "b", "r", "b", "r", "b", "b", "r",
	    "b", "r", "b", "r", "b", "r", "r", "b", "r", "b", "r", "b",
	    "r", "b", "r", "b", "b", "r", "b", "r", "b", "r", "b", "r"
    ];

    // board border color:
    var g_s_c_board_b = ["#DFBC33", "#DFBC33", "white"];

    // number text color:
    var g_s_c_num = ["white", "#434343", "#f3f3f3"];

    // number background color:
    var g_s_c_num_bk_g = ["#35A300", "white", "white"]; // green
    var g_s_c_num_bk_r = ["#CC2200", "white", "white"]; // red
    var g_s_c_num_bk_b = ["#222222", "white", "white"]; // black

    // queue background color:
    var g_s_c_que_bk_g = ["35A300", "#D3EED3", "white"]; // green
    var g_s_c_que_bk_r = ["CC2200", "white", "white"]; // red
    var g_s_c_que_bk_b = ["222222", "#EAEAEA", "white"]; // black

    // queue border color:
    var g_s_c_que_b_g = ["white", "#CCFFCC", "white"]; 
    var g_s_c_que_b_r = ["white", "#FFDDAA", "white"]; 
    var g_s_c_que_b_b = ["white", "#DDDDDD", "white"]; 

    // button background color:
    var g_s_c_btn_bk_enabled = ["#008838", "white", "white"];
    var g_s_c_btn_bk_disabled = ["#888888", "white", "white"];

    // button text color:
    var g_s_c_btn_enabled = ["white", "#AA8833", "#f3f3f3"];
    var g_s_c_btn_disabled = ["white", "BBBBBB", "#f3f3f3"];

    // button border color:
    var g_s_c_btn_b_enabled = ["white", "#AA8833", "white"];
    var g_s_c_btn_b_disabled = ["white", "BBBBBB", "white"];

    // 3c3r color
    var g_s_c_3c3r = ["black", "black", "#f3f3f3"]; // text color
    var g_s_c_3c3r_bk = ["#EBE3CB", "white", "white"]; // background color
    var g_s_c_3c3r_t_bk = ["#DFD7CB", "white", "white"]; // title background color

    // 3c3r >=5 color
    var g_s_c_3c3r_5 = ["white", "black", "#f3f3f3"]; // text color
    var g_s_c_3c3r_5_bk = ["rgb(158,118,200)", "#EEEEEE", "white"]; // background color
    var g_s_c_3c3r_5_t_bk = ["rgb(128,88,158)", "#DDDDDD", "white"]; // title background color

    // 3c3r >=6 background color
    var g_s_c_3c3r_6 = ["white", "black", "#f3f3f3"]; // text color
    var g_s_c_3c3r_6_bk = ["rgb(0,128,255)", "#EBE3CB", "white"]; // background color
    var g_s_c_3c3r_6_t_bk = ["rgb(0,93,218)", "#DFD7CB", "white"]; // title background color

    // 3c3r border color
    var g_s_c_3c3r_b = ["white", "#AA8833", "white"];

    // global variables: ------------------------------------------------------

    var MAX_COUNT = 10000;
    var QUEUE_MAX_COUNT = 100;

    var g_anQueueNum = [];
    var g_nQueueIdx = -1;

    var g_an3C3R = [];
    var g_anIdx3C3R = [];

    var g_nExpandStatus = 0;
    var g_nShowInputStatus = 1;

    var g_aGame = [];

    function OnTest()
    {
    }

    function GetNumCol(num)
    {
        return Math.floor((num - 1) / 12);
    }

    function GetNumRow(num)
    {
        var nRow = num % 3;
        if (nRow == 1)
        {
            nRow = 2;
        }
        else if (nRow == 2)
        {
            nRow = 1;
        }

        return nRow;
    }

    // classes: ---------------------------------------------------------------

    function CGameItem()
    {
        this.nIdx = 1;
        this.nBet3C3R = -1; // 0 ~ 2: columns; 3 ~ 5: rows
        this.nDistance = 0;
        this.nRound = 0;
        this.nMoney = 0;
        this.nStatus = 1;
        this.nHit = 0;
    }

    function CGame(nIdxRule)
    {
        this.nIdxRule = nIdxRule;
        this.nCount = 0;
        this.nMoney = 0;

        this.nCountCompleted = 0;
        this.nCountWon = 0;
        this.nCountDrew = 0;
        this.nCountLost = 0;
        this.nCountHit = 0;

        this.nBalance = 0;
        this.aItem = [];

        this.nShowStatus = 0;

        this.AfterItemEnds = function(item)
        {
            this.nCountCompleted++;

            if (item.nMoney > 0)
                this.nCountWon++;
            else if (item.nMoney == 0)
                this.nCountDrew++;
            else
                this.nCountLost++;

            if (item.nHit == 1)
                this.nCountHit++;

            this.nBalance += item.nMoney;
        }

        this.Add = function(item)
        {
            this.aItem[this.nCount] = item;
            this.aItem[this.nCount].nIdx = this.nCount;
            this.nCount++;
        }

        this.RemoveAt = function(nIdx)
        {
            if((this.nCount <= 0) || (nIdx >= this.nCount))
            {
                return;
            }
            for (var n = nIdx; n < (this.nCount - 1) ; ++n)
            {
                this.aItem[n] = this.aItem[n + 1];
                this.aItem[n].nIdx--;
            }
            this.aItem[this.nCount - 1] = null;
            this.nCount--;
        }

        this.RemoveAll = function()
        {
            for (var n = 0; n < this.nCount; ++n)
            {
                this.aItem[n] = null;
            }
            this.nCount = 0;
        }

        this.AddNum = function(num)
        {
            var nNumCol = GetNumCol(num);
            var nNumRow = GetNumRow(num);

            // add distance for all item:

            for (var n = 0; n < this.nCount; ++n)
            {
                this.aItem[n].nDistance++;
            }

            // number 0:

            if (num == 0)
            {
                this.nMoney = this.nBalance;
                for(var n = 0; n < this.nCount; ++n)
                {
                    if (this.aItem[n].nStatus == 0)
                        continue;

                    this.aItem[n].nMoney -= g_aGameRule[this.nIdxRule].anBet[this.aItem[n].nRound - 1];
                    this.nMoney += this.aItem[n].nMoney;
                }

                return;
            }

            var anNum3C3R = [nNumCol, nNumRow + 3];

            var abHitted = [false, false];

            // whether hitted by column or row:

            for (var nn = 0; nn < 2; ++nn)
            {
                for (var n = 0; n < this.nCount; ++n)
                {
                    if (this.aItem[n].nStatus == 0)
                        continue;

                    if (this.aItem[n].nBet3C3R == anNum3C3R[nn])
                    {
                        this.aItem[n].nMoney += g_aGameRule[this.nIdxRule].anBet[this.aItem[n].nRound - 1] * 3;
                        this.aItem[n].nStatus = 0;
                        this.aItem[n].nHit = 1;

                        this.AfterItemEnds(this.aItem[n]);
                        abHitted[nn] = true;
                    }
                }
            }

            // increase round, see if it ends:

            for (var n = 0; n < this.nCount; ++n)
            {
                if (this.aItem[n].nStatus == 0)
                    continue;

                this.aItem[n].nRound++;
                this.aItem[n].nMoney -= g_aGameRule[this.nIdxRule].anBet[this.aItem[n].nRound - 1];

                if (this.aItem[n].nRound == g_aGameRule[this.nIdxRule].nRound)
                {
                    this.aItem[n].nStatus = 0;
                    this.aItem[n].nHit = 0;

                    this.AfterItemEnds(this.aItem[n]);
                }
            }

            // whether a new game start:

            for (var n = 0; n < 6; ++n)
            {
                if (g_an3C3R[n] == g_aGameRule[this.nIdxRule].nSkip)
                {
                    var item = new CGameItem();
                    item.nBet3C3R = n;
                    item.nDistance = 0;
                    item.nRound = 1;
                    item.nMoney = -g_aGameRule[this.nIdxRule].anBet[0];
                    item.nStatus = 1;

                    this.Add(item);
                }
            }

            // calculate realtime money:

            this.nMoney = this.nBalance;
            for(var n = 0; n < this.nCount; ++n)
            {
                if (this.aItem[n].nStatus == 0)
                    continue;

                this.nMoney += this.aItem[n].nMoney;
            }
        }
    }

    function CGameRule()
    {
        this.nSkip;
        this.nRound;
        this.anBet = [];
        this.strSpec;
    }

    var GAME_COUNT = 3;
    var g_aGameRule = [];

    function InitGameRuleList()
    {
        GAME_COUNT = 4;

        var rule0 = new CGameRule();
        rule0.nSkip = 6;
        rule0.nRound = 6;
        rule0.anBet = [10, 10, 10, 20, 20, 30];
        rule0.strSpec = "WW_6_111223";

        var rule1 = new CGameRule();
        rule1.nSkip = 5;
        rule1.nRound = 6;
        rule1.anBet = [10, 10, 10, 20, 20, 30];
        rule1.strSpec = "WW_5_111223";

        var rule2 = new CGameRule();
        rule2.nSkip = 5;
        rule2.nRound = 4;
        rule2.anBet = [10, 20, 40, 80];
        rule2.strSpec = "WZS_5_1248";

        var rule3 = new CGameRule();
        rule3.nSkip = 5;
        rule3.nRound = 4;
        rule3.anBet = [20, 30, 40, 60];
        rule3.strSpec = "WZS_5_2346";

        g_aGameRule[0] = rule2;
        g_aGameRule[1] = rule3;
        g_aGameRule[2] = rule0;
        g_aGameRule[3] = rule1;
    }

    // functions: -------------------------------------------------------------

    function GetNumberColor()
    {
        return g_s_c_num[g_s_theme_id];
    }

    function GetNumberBackgroundColor(num)
    {
        var strColor = g_astrNumberColor[num];

	    if(strColor == "r")
	    {
	        return g_s_c_num_bk_r[g_s_theme_id];
	    }
	    else if(strColor == "b")
	    {
	        return g_s_c_num_bk_b[g_s_theme_id];
	    }
	    else
	    {
	        return g_s_c_num_bk_g[g_s_theme_id];
	    }
    }

    function GetQueueNumberBackgroundColor(num)
    {
        var strColor = g_astrNumberColor[num];

        if (strColor == "r")
        {
            return g_s_c_que_bk_r[g_s_theme_id];
        }
        else if (strColor == "b")
        {
            return g_s_c_que_bk_b[g_s_theme_id];
        }
        else
        {
            return g_s_c_que_bk_g[g_s_theme_id];
        }
    }

    function GetQueueNumberBorderColor(num)
    {
        var strColor = g_astrNumberColor[num];

        if (strColor == "r")
        {
            return g_s_c_que_b_r[g_s_theme_id];
        }
        else if (strColor == "b")
        {
            return g_s_c_que_b_b[g_s_theme_id];
        }
        else
        {
            return g_s_c_que_b_g[g_s_theme_id];
        }
    }


    function InitStyles()
    {
        var tbl = document.getElementById("tblBoard");
        tbl.style.borderColor = g_s_c_board_b[g_s_theme_id];

        for(var n = 0; n <= 36; ++n)
        {
            var td = document.getElementById("tdB" + n.toString());
            td.style.backgroundColor = GetNumberBackgroundColor(n);
            td.style.borderColor = g_s_c_board_b[g_s_theme_id];
            td.style.color = GetNumberColor();
        }
    }

    function GetQueueItemBorderStyle(num)
    {
        return "1px solid " + GetQueueNumberBorderColor(num);
    }

    // styles: <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<


    function ShowQueue()
    {
        var nStart = 0;
        if (g_nQueueIdx > QUEUE_MAX_COUNT)
            nStart = g_nQueueIdx - QUEUE_MAX_COUNT;

        for (var n = nStart; n <= g_nQueueIdx; ++n)
        {
            var nn = (n - nStart);
            var nIdx = g_nQueueIdx - nn;

            var strIdTd = "td" + nn.toString();
		    var td = document.getElementById(strIdTd);
		    td.innerHTML = g_anQueueNum[nIdx];
		    td.style.backgroundColor = GetQueueNumberBackgroundColor(g_anQueueNum[nIdx]);
		    td.style.color = GetNumberColor();
		    td.style.border = GetQueueItemBorderStyle(g_anQueueNum[nIdx]);
        }

        for (var n = g_nQueueIdx + 1; n < QUEUE_MAX_COUNT; ++n)
	    {
		    var strIdTd = "td" + n.toString();
		    var td = document.getElementById(strIdTd);
		    td.innerHTML = "&nbsp;";
		    td.style.backgroundColor = "#FFFFFF";
	    }

	    var nQueueRow = 0;

	    if (g_nQueueIdx >= 0)
        {
	        nQueueRow = Math.floor((g_nQueueIdx - nStart) / 20) + 1;
	    }

	    var strID = "divBlank";
	    var div = document.getElementById(strID);
	    if (nQueueRow == 0)
	        div.style.display = "none";
	    else
	        div.style.display = "";

	    for (var n = 1; n <= 5; ++n)
	    {
	        strID = "trRow" + n.toString();
	        var tr = document.getElementById(strID);
	        if ((nQueueRow > 0) && ((n == 1) || ((n <= nQueueRow) && (g_nExpandStatus == 1))))
	            tr.style.display = "";
            else
	            tr.style.display = "none";
	    }
    }

    function RefreshButtons()
    {
        var strBkClrDisabled = g_s_c_btn_bk_disabled[g_s_theme_id];
        var strBkClrEnabled = g_s_c_btn_bk_enabled[g_s_theme_id];

        var strClrDisabled = g_s_c_btn_disabled[g_s_theme_id];
        var strClrEnabled = g_s_c_btn_enabled[g_s_theme_id];

        var strBorderClrDisabled = g_s_c_btn_b_disabled[g_s_theme_id];
        var strBorderClrEnabled = g_s_c_btn_b_enabled[g_s_theme_id];

        var strBkClrDelete = strBkClrDisabled;
        var strClrDelete = strClrDisabled;
        var strBorderClrDelete = strBorderClrDisabled;

        var strBkClrExpand = strBkClrDisabled;
        var strClrExpand = strClrDisabled;
        var strBorderClrExpand = strBorderClrDisabled;

        var strBkClrRestart = strBkClrDisabled;
        var strClrRestart = strClrDisabled;
        var strBorderClrRestart = strBorderClrDisabled;

        var strBkClrTheme = strBkClrEnabled;
        var strClrTheme = strClrEnabled;
        var strBorderClrTheme = strBorderClrEnabled;

        if (g_nQueueIdx >= 0)
        {
            strBkClrDelete = strBkClrEnabled;
            strClrDelete = strClrEnabled;
            strBorderClrDelete = strBorderClrEnabled;

            strBkClrRestart = strBkClrEnabled;
            strClrRestart = strClrEnabled;
            strBorderClrRestart = strBorderClrEnabled;
        }
        if (g_nQueueIdx >= 20)
        {
            strBkClrExpand = strBkClrEnabled;
            strClrExpand = strClrEnabled;
            strBorderClrExpand = strBorderClrEnabled;
        }
        else
        {
            g_nExpandStatus = 0;
        }

        var strBttnExpand = "展开";
        if(g_nExpandStatus == 1)
        {
            strBttnExpand = "收起";
        }

        var bttn = document.getElementById("tdBttnDelete");
        bttn.style.backgroundColor = strBkClrDelete;
        bttn.style.color = strClrDelete;
        bttn.style.borderColor = strBorderClrDelete;

        bttn = document.getElementById("tdBttnExpand");
        bttn.style.backgroundColor = strBkClrExpand;
        bttn.style.color = strClrExpand;
        bttn.style.borderColor = strBorderClrExpand;
        bttn.innerHTML = strBttnExpand;

        bttn = document.getElementById("tdBttnRestart");
        bttn.style.backgroundColor = strBkClrRestart;
        bttn.style.color = strClrRestart;
        bttn.style.borderColor = strBorderClrRestart;

        bttn = document.getElementById("tdBttnTheme");
        bttn.style.backgroundColor = strBkClrTheme;
        bttn.style.color = strClrTheme;
        bttn.style.borderColor = strBorderClrTheme;
    }

    function Calc3C3R_Add(num)
    {
        if(num == 0) return;
	
        var nCol = GetNumCol(num);
        var nRow = GetNumRow(num);

        for (var n = 0; n < 6; ++n)
        {
            g_an3C3R[n]++;
        }

        g_an3C3R[nCol] = 0;
        g_an3C3R[3+nRow] = 0;
    }

    function Calc3C3R_Delete()
    {
        var abOccur = [];

        for (var n = 0; n < 6; ++n)
        {
            g_an3C3R[n] = 0;
            g_anIdx3C3R[n] = n;
            abOccur[n] = false;
        }

        for (var n = g_nQueueIdx; n >= 0; --n)
        {
            var num = g_anQueueNum[n];
            if (num == 0) continue;

            var nCol = Math.floor((num - 1) / 12);
            var nRow = num % 3;
            if (nRow == 1)
            {
                nRow = 2;
            }
            else if (nRow == 2)
            {
                nRow = 1;
            }

            var bChanged = false;

            for (var nn = 0; nn < 6; ++nn)
            {
                if(!abOccur[nn])
                {
                    if((nn == nCol) || (nn == (nRow + 3)))
                    {
                        abOccur[nn] = true;
                    }
                    else
                    {
                        g_an3C3R[nn]++;
                        bChanged = true;
                    }
                }
            }

            if (!bChanged)
                break;
        }
    }

    function Sort3C3R()
    {
        // sort:
        var bChanged = false;
        do
        {
            bChanged = false;

            for (var n = 0; n < 5; ++n)
            {
                if (g_an3C3R[g_anIdx3C3R[n]] < g_an3C3R[g_anIdx3C3R[n + 1]])
                {
                    tmp = g_anIdx3C3R[n];
                    g_anIdx3C3R[n] = g_anIdx3C3R[n + 1];
                    g_anIdx3C3R[n + 1] = tmp;

                    bChanged = true;
                }
            }
        } while (bChanged);
    }

    function GetColRowSpec(nIdx3C3R)
    {
        var strSpec;

        if (nIdx3C3R < 3)
        {
            if (nIdx3C3R == 0)
                strSpec = "第一组";
            else if (nIdx3C3R == 1)
                strSpec = "第二组";
            else
                strSpec = "第三组";
        }
        else
        {
            strSpec = "第" + (nIdx3C3R - 3 + 1).toString() + "行";
        }

        return strSpec;
    }

    function Show3C3R()
    {
        // show:
        for (var n = 0; n < 6; ++n)
	    {
		    var strIdTd = "td3C3R" + n.toString();
		    var td = document.getElementById(strIdTd);
		    td.innerHTML = g_an3C3R[g_anIdx3C3R[n]];
		    strIdTd = "tdT3C3R" + n.toString();
		    var strTitle = GetColRowSpec(g_anIdx3C3R[n]);
		    var tdT = document.getElementById(strIdTd);
		    tdT.innerHTML = strTitle;

		    if (g_an3C3R[g_anIdx3C3R[n]] >= 5)
		    {
		        if (g_an3C3R[g_anIdx3C3R[n]] > 5)
                {
		            td.style.color = g_s_c_3c3r_6[g_s_theme_id];
		            tdT.style.color = g_s_c_3c3r_6[g_s_theme_id];
		            td.style.backgroundColor = g_s_c_3c3r_6_bk[g_s_theme_id];
		            tdT.style.backgroundColor = g_s_c_3c3r_6_t_bk[g_s_theme_id];
		        }
                else
		        {
		            td.style.color = g_s_c_3c3r_5[g_s_theme_id];
		            tdT.style.color = g_s_c_3c3r_5[g_s_theme_id];
		            td.style.backgroundColor = g_s_c_3c3r_5_bk[g_s_theme_id];
		            tdT.style.backgroundColor = g_s_c_3c3r_5_t_bk[g_s_theme_id];
                }
		        td.style.fontWeight = "bold";
            }
            else
		    {
		        td.style.color = g_s_c_3c3r[g_s_theme_id];
		        tdT.style.color = g_s_c_3c3r[g_s_theme_id];
		        td.style.backgroundColor = g_s_c_3c3r_bk[g_s_theme_id];
		        tdT.style.backgroundColor = g_s_c_3c3r_t_bk[g_s_theme_id];

		        td.style.fontWeight = "normal";
		    }

		    td.style.borderColor = g_s_c_3c3r_b[g_s_theme_id];
		    tdT.style.borderColor = g_s_c_3c3r_b[g_s_theme_id];
        }
    }

    function OnGameClick(nGameIdx)
    {
        var strDisplay = "";
        if(g_aGame[nGameIdx].nShowStatus == 1)
        {
            strDisplay = "none";
            g_aGame[nGameIdx].nShowStatus = 0;
        }
        else
        {
            g_aGame[nGameIdx].nShowStatus = 1;
        }

        var tbl = document.getElementById("tblGame" + nGameIdx.toString());
        tbl.style.display = strDisplay;
    }


    function ShowGames()
    {
        for (var nn = 0; nn < GAME_COUNT; ++nn)
        {
            if (g_aGame[nn].nCount > 0)
            {
                var div = document.getElementById("divGame" + (nn + 1).toString());
                var strHtml = "<table cellpadding='0' cellspacing='0' class='tblGameSum' onclick='OnGameClick(" + nn.toString();
                strHtml += ")'><tr><td>";
                strHtml += g_aGameRule[g_aGame[nn].nIdxRule].strSpec;
                strHtml += "</td><td>"
                strHtml += "完成:";
                strHtml += g_aGame[nn].nCountCompleted.toString();
                strHtml += "</td><td>"
                strHtml += "赢:";
                strHtml += g_aGame[nn].nCountWon.toString();
                strHtml += "</td><td>"
                strHtml += "平:";
                strHtml += g_aGame[nn].nCountDrew.toString();
                strHtml += "</td><td>"
                strHtml += "输:";
                strHtml += g_aGame[nn].nCountLost.toString();
                strHtml += "</td><td>"
                strHtml += "结算:";
                strHtml += g_aGame[nn].nBalance.toString();
                strHtml += "</td><td>"
                strHtml += "实时:";
                strHtml += g_aGame[nn].nMoney.toString();
                strHtml += "</td></tr></table>";
                strHtml += "<table cellpadding='0' cellspacing='0' class='tblGame' id='tblGame" + nn.toString();
                strHtml += "' style='display: none'><tr class='trTitle'><td>编号</td><td>押</td><td>轮次</td><td>距离</td><td>输赢</td><td>押中</td></tr>";
                var nLastIdx = 0;
                if (g_aGame[nn].nCount > 10)
                    nLastIdx = g_aGame[nn].nCount - 10;

                for (var n = g_aGame[nn].nCount - 1; n >= nLastIdx; --n)
                {
                    var strCls = "trActive";
                    if (g_aGame[nn].aItem[n].nStatus == 0)
                    {
                        if (g_aGame[nn].aItem[n].nMoney > 0)
                            strCls = "trWon";
                        else if (g_aGame[nn].aItem[n].nMoney == 0)
                            strCls = "trDrew";
                        else
                            strCls = "trLost";
                    }
                    strHtml += "<tr class='trItems ";
                    strHtml += strCls;
                    strHtml += "'><td>" + (g_aGame[nn].aItem[n].nIdx + 1).toString() + "</td>";
                    strHtml += "<td>" + GetColRowSpec(g_aGame[nn].aItem[n].nBet3C3R) + "</td>";
                    strHtml += "<td>" + g_aGame[nn].aItem[n].nRound.toString() + "</td>";
                    strHtml += "<td>" + g_aGame[nn].aItem[n].nDistance.toString() + "</td>";
                    strHtml += "<td>" + g_aGame[nn].aItem[n].nMoney.toString() + "</td>";
                    strHtml += "<td>" + ((g_aGame[nn].aItem[n].nHit == 1)? "中" : "&nbsp;") + "</td>";
                    strHtml += "</tr>";
                }
                strHtml += "</table>";

                div.innerHTML = strHtml;
            }
        }
    }

    function RefreshTheme()
    {
        var strTitle = "淡雅版";

        if(g_s_theme_id == 1)
        {
            strTitle = "彩色版";
        }

        var bttn = document.getElementById("tdBttnTheme");
        bttn.innerHTML = strTitle;

        InitStyles();
        Show3C3R();
        ShowQueue();
        RefreshButtons();
    }

    function Refresh(bInit)
    {
        g_nQueueIdx = -1;

        for (var n = 0; n < 6; ++n)
	    {
	        g_an3C3R[n] = 0;
	        g_anIdx3C3R[n] = n;
	    }

        for (var n = 0; n < GAME_COUNT; ++n)
	    {
	        if (bInit)
	        {
	            var game = new CGame(n);
	            game.nCount = 0;

	            g_aGame[n] = game;
	        }
            else
	        {
	            g_aGame[n].RemoveAll();
	        }
	    }

	    RefreshTheme();
    }

    function OnPageInit()
    {
        OnTest();
        InitGameRuleList();

        Refresh(true);
    }

    function OnClick(num)
    {
        // queue: -------------------------------

        if (g_nQueueIdx == (MAX_COUNT - 1))
        {
            for (var n = 0; n <= g_nQueueIdx - 1; ++n)
            {
                g_anQueueNum[n] = g_anQueueNum[n + 1];
            }
        }
        else
        {
            g_nQueueIdx++;
        }

        g_anQueueNum[g_nQueueIdx] = num;

        ShowQueue();

        // 3C3R: --------------------------------

        Calc3C3R_Add(num);
        Sort3C3R();
        Show3C3R();
	
        // games: -------------------------------

        for (var n = 0; n < GAME_COUNT; ++n)
        {
            g_aGame[n].AddNum(num);
        }

        ShowGames();

        // buttons: -----------------------------

	    RefreshButtons();
    }

    function OnDelete()
    {
        if (g_nQueueIdx < 0)
            return;

        if (g_nQueueIdx == 0)
        {
            Refresh(false);
            return;
        }

        --g_nQueueIdx;

        Calc3C3R_Delete();

        Sort3C3R();
        Show3C3R();
        ShowQueue();
        RefreshButtons();
    }

    function OnExpand()
    {
        g_nExpandStatus++;
        g_nExpandStatus = g_nExpandStatus % 2;

        ShowQueue();
        RefreshButtons();
    }

    function OnRestart()
    {
        if (g_nQueueIdx < 0)
            return;
        
        var confirmed = confirm("确定要重新开始？");
        if(confirmed != 0)
            Refresh(false);
    }

    function OnChangeTheme()
    {
        if (g_s_theme_id > 1)
            return;

        if(g_s_theme_id == 0)
        {
            g_s_theme_id = 1;
        }
        else
        {
            g_s_theme_id = 0;
        }

        RefreshTheme();
    }

    function OnShowInputClick()
    {
        var div = document.getElementById("divInput");
        var strDisplay = "";

        if(g_nShowInputStatus == 1)
        {
            g_nShowInputStatus = 0;
            strDisplay = "none";
        }
        else
        {
            g_nShowInputStatus = 1;
        }

        div.style.display = strDisplay;
    }

</script>

</head>
<body onload="OnPageInit()">
    <div style="position:fixed; z-index:99; right: 0px; top:0px; width: 120px; height: 120px; opacity: 0;" onclick="OnShowInputClick()"></div>
    <div style="position:absolute; z-index:0">
        <table cellpadding="0" cellspacing="0" border="0" id="tblStatistics">
            <tr>
                <td class="title_c" id="tdT3C3R0">第1组</td>
                <td class="value_c" id="td3C3R0">0</td>
                <td>&nbsp;&nbsp;</td>
                <td class="title_c" id="tdT3C3R1">第2组</td>
                <td class="value_c" id="td3C3R1">0</td>
                <td>&nbsp;&nbsp;</td>
                <td class="title_c" id="tdT3C3R2">第3组</td>
                <td class="value_c" id="td3C3R2">0</td>
                <td>&nbsp;&nbsp;</td>
                <td class="title_c" id="tdT3C3R3">第1行</td>
                <td class="value_c" id="td3C3R3">0</td>
                <td>&nbsp;&nbsp;</td>
                <td class="title_c" id="tdT3C3R4">第2行</td>
                <td class="value_c" id="td3C3R4">0</td>
                <td>&nbsp;&nbsp;</td>
                <td class="title_c" id="tdT3C3R5">第3行</td>
                <td class="value_c" id="td3C3R5">0</td>
            </tr>
        </table>
        <div style="height: 8px" id="divBlank"></div>
        <table cellpadding="0" cellspacing="5" border="0" id="tblQueue">
            <tr id="trRow1">
                <td id="td0"></td>
                <td id="td1"></td>
                <td id="td2"></td>
                <td id="td3"></td>
                <td id="td4"></td>
                <td id="td5"></td>
                <td id="td6"></td>
                <td id="td7"></td>
                <td id="td8"></td>
                <td id="td9"></td>
                <td id="td10"></td>
                <td id="td11"></td>
                <td id="td12"></td>
                <td id="td13"></td>
                <td id="td14"></td>
                <td id="td15"></td>
                <td id="td16"></td>
                <td id="td17"></td>
                <td id="td18"></td>
                <td id="td19"></td>
            </tr>
            <tr id="trRow2">
                <td id="td20"></td>
                <td id="td21"></td>
                <td id="td22"></td>
                <td id="td23"></td>
                <td id="td24"></td>
                <td id="td25"></td>
                <td id="td26"></td>
                <td id="td27"></td>
                <td id="td28"></td>
                <td id="td29"></td>
                <td id="td30"></td>
                <td id="td31"></td>
                <td id="td32"></td>
                <td id="td33"></td>
                <td id="td34"></td>
                <td id="td35"></td>
                <td id="td36"></td>
                <td id="td37"></td>
                <td id="td38"></td>
                <td id="td39"></td>
            </tr>
            <tr id="trRow3">
                <td id="td40"></td>
                <td id="td41"></td>
                <td id="td42"></td>
                <td id="td43"></td>
                <td id="td44"></td>
                <td id="td45"></td>
                <td id="td46"></td>
                <td id="td47"></td>
                <td id="td48"></td>
                <td id="td49"></td>
                <td id="td50"></td>
                <td id="td51"></td>
                <td id="td52"></td>
                <td id="td53"></td>
                <td id="td54"></td>
                <td id="td55"></td>
                <td id="td56"></td>
                <td id="td57"></td>
                <td id="td58"></td>
                <td id="td59"></td>
            </tr>
            <tr id="trRow4">
                <td id="td60"></td>
                <td id="td61"></td>
                <td id="td62"></td>
                <td id="td63"></td>
                <td id="td64"></td>
                <td id="td65"></td>
                <td id="td66"></td>
                <td id="td67"></td>
                <td id="td68"></td>
                <td id="td69"></td>
                <td id="td70"></td>
                <td id="td71"></td>
                <td id="td72"></td>
                <td id="td73"></td>
                <td id="td74"></td>
                <td id="td75"></td>
                <td id="td76"></td>
                <td id="td77"></td>
                <td id="td78"></td>
                <td id="td79"></td>
            </tr>
            <tr id="trRow5">
                <td id="td80"></td>
                <td id="td81"></td>
                <td id="td82"></td>
                <td id="td83"></td>
                <td id="td84"></td>
                <td id="td85"></td>
                <td id="td86"></td>
                <td id="td87"></td>
                <td id="td88"></td>
                <td id="td89"></td>
                <td id="td90"></td>
                <td id="td91"></td>
                <td id="td92"></td>
                <td id="td93"></td>
                <td id="td94"></td>
                <td id="td95"></td>
                <td id="td96"></td>
                <td id="td97"></td>
                <td id="td98"></td>
                <td id="td99"></td>
            </tr>
        </table>
        <div style="height: 8px"></div>

        <table cellpadding="0" cellspacing="0" border="0">
            <tr>
                <td id="tdBttnDelete" class="bttn" style="background-color: #007820" onclick="OnDelete()">删除</td>
                <td>&nbsp;&nbsp;&nbsp;</td>
                <td id="tdBttnExpand" class="bttn" style="background-color: #007820" onclick="OnExpand()">展开</td>
                <td>&nbsp;&nbsp;&nbsp;</td>
                <td id="tdBttnRestart" class="bttn" style="background-color: #007820" onclick="OnRestart()">重新开始</td>
                <td>&nbsp;&nbsp;&nbsp;</td>
                <td id="tdBttnTheme" class="bttn" style="background-color: #007820" onclick="OnChangeTheme()">NA</td>
            </tr>
        </table>
        <div style="height: 18px"></div>
        <div id="divGame1" style="font-size: 24px"></div>
        <div id="divGame2" style="font-size: 24px"></div>
        <div id="divGame3" style="font-size: 24px"></div>
        <div id="divGame4" style="font-size: 24px"></div>
    </div>
    <div id="divInput" style="position:fixed; top: 200px; z-index:9; width: 100%; padding: 13px 0; background-color: #EEEEEE; ">
        <table cellpadding="0" cellspacing="0" id="tblBoard">
            <tr>
                <td id="tdB0" rowspan="3" onclick="OnClick(0)">0</td>
                <td id="tdB3" onclick="OnClick(3)">3</td>
                <td id="tdB6" onclick="OnClick(6)">6</td>
                <td id="tdB9" onclick="OnClick(9)">9</td>
                <td id="tdB12" onclick="OnClick(12)">12</td>
                <td id="tdB15" onclick="OnClick(15)">15</td>
                <td id="tdB18" onclick="OnClick(18)">18</td>
                <td id="tdB21" onclick="OnClick(21)">21</td>
                <td id="tdB24" onclick="OnClick(24)">24</td>
                <td id="tdB27" onclick="OnClick(27)">27</td>
                <td id="tdB30" onclick="OnClick(30)">30</td>
                <td id="tdB33" onclick="OnClick(33)">33</td>
                <td id="tdB36" onclick="OnClick(36)">36</td>
            </tr>
            <tr>
                <td id="tdB2" onclick="OnClick(2)">2</td>
                <td id="tdB5" onclick="OnClick(5)">5</td>
                <td id="tdB8" onclick="OnClick(8)">8</td>
                <td id="tdB11" onclick="OnClick(11)">11</td>
                <td id="tdB14" onclick="OnClick(14)">14</td>
                <td id="tdB17" onclick="OnClick(17)">17</td>
                <td id="tdB20" onclick="OnClick(20)">20</td>
                <td id="tdB23" onclick="OnClick(23)">23</td>
                <td id="tdB26" onclick="OnClick(26)">26</td>
                <td id="tdB29" onclick="OnClick(29)">29</td>
                <td id="tdB32" onclick="OnClick(32)">32</td>
                <td id="tdB35" onclick="OnClick(35)">35</td>
            </tr>
            <tr>
                <td id="tdB1" onclick="OnClick(1)">1</td>
                <td id="tdB4" onclick="OnClick(4)">4</td>
                <td id="tdB7" onclick="OnClick(7)">7</td>
                <td id="tdB10" onclick="OnClick(10)">10</td>
                <td id="tdB13" onclick="OnClick(13)">13</td>
                <td id="tdB16" onclick="OnClick(16)">16</td>
                <td id="tdB19" onclick="OnClick(19)">19</td>
                <td id="tdB22" onclick="OnClick(22)">22</td>
                <td id="tdB25" onclick="OnClick(25)">25</td>
                <td id="tdB28" onclick="OnClick(28)">28</td>
                <td id="tdB31" onclick="OnClick(31)">31</td>
                <td id="tdB34" onclick="OnClick(34)">34</td>
            </tr>
        </table>
    </div>
</body>
</html>